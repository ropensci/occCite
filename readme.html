<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Introduction • occCite</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>




<meta property="og:title" content="Introduction" />
<meta property="og:image" content="/reference/figures/occTag.png" />
<meta property="og:image:alt" content="Gray specimen tag that says 'occCite: Tools for querying and citing large occurrence datasets'" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@hannahOish" />
<meta name="twitter:site" content="@hannahOish" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">occCite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/occCite_Vignette.html">An overview of executing searches and generating citations using occCite</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hannahlowens/occCite/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Introduction</h1>
    </div>


<p><a href="https://github.com/hannahlowens/occCite/actions"><img src="https://github.com/hannahlowens/occCite/workflows/R-CMD-check/badge.svg" alt="R build status"></a> <a href="https://cran.r-project.org/package=occCite"><img src="https://www.r-pkg.org/badges/version/occCite" alt="cran version"></a> <a href="https://github.com/r-hub/cranlogs.app"><img src="https://cranlogs.r-pkg.org/badges/occCite" alt="rstudio mirror downloads"></a> <!-- badges: end --></p>
<div id="introduction" class="section level1">

<p>We have entered the age of data-intensive scientific discovery. As datasets increase in complexity and heterogeneity, we must preserve the cycle of data citation from primary data sources to aggregating databases to research products and back to primary data sources. The citation cycle keeps science transparent, but it is also key to supporting primary providers by documenting the use of their data. The Global Biodiversity Information Facility and other data aggregators have made great strides in harvesting citation data from research products and linking them back to primary data providers. However, this only works if those that publish research products cite primary data sources in the first place. We developed <code>occCite</code>, a set of <code>R</code>-based tools for downloading, managing, and citing biodiversity data, to advance toward the goal of closing the data provenance cycle. These tools preserve links between occurrence data and primary providers once researchers download aggregated data, and facilitate the citation of primary data providers in research papers.</p>
<p>The <code>occCite</code> work flow follows a three-step process. First, the user inputs one or more taxonomic names (or a phylogeny). <code>occCite</code> then rectifies those names by checking them against one or more taxonomic databases, which can be specified by the user (see the <a href="http://gni.globalnames.org/%7D">Global Names List</a>). The results of the taxonomic rectification are then kept in an <code>occCiteData</code> object in local memory. Next, <code>occCite</code> takes the <code>occCiteData</code> object and user-defined search parameters to query BIEN (through <code>rbien</code>) and/or GBIF(through <code>rGBIF</code>) for records. The results are appended to the <code>occCiteData</code> object, along with metadata on the search. Finally, the user can pass the <code>occCiteData</code> object to <code>occCitation</code>, which compiles citations for the primary providers, database aggregators, and <code>R</code> packages used to build the dataset.</p>
<p>For an overview tutorial video of the package, see <a href="https://www.youtube.com/watch?v=7qSCULN_VjY&amp;t=17s">our YouTube video</a>.</p>
<p>Future iterations of <code>occCite</code> will track citation data through the data cleaning process and provide a series of visualizations on raw query results and final datasets. It will also provide data citations in a format congruent with best-practice recommendations for large biodiversity datasets. Based on these data citation tools, we will also propose a new set of standards for citing primary biodiversity data in published research articles that provides due credit to contributors and allows them to track the use of their work. Keep checking back!</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>If you plan to query GBIF, you will need to provide them with your user login information. We have provided a dummy login below to show you the format. <em>You will need to provide actual account information.</em> This is because you will actually be downloading <em>all</em> of the records available for the species using <code>occ_download()</code>, instead of getting results from <code>occ_search()</code>, which has a hard limit of 200,000 occurrences.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hannahlowens/occCite">occCite</a></span><span class="op">)</span>;
<span class="co">#Creating a GBIF login</span>
<span class="va">GBIFLogin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GBIFLoginManager.html">GBIFLoginManager</a></span><span class="op">(</span>user <span class="op">=</span> <span class="st">"occCiteTester"</span>,
                          email <span class="op">=</span> <span class="st">"****@yahoo.com"</span>,
                          pwd <span class="op">=</span> <span class="st">"12345"</span><span class="op">)</span></code></pre></div>
</div>
<div id="performing-a-simple-search" class="section level1">
<h1 class="hasAnchor">
<a href="#performing-a-simple-search" class="anchor"></a>Performing a simple search</h1>
<div id="the-basics" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basics" class="anchor"></a>The basics</h2>
<p>At its simplest, <code>occCite</code> allows you to search for occurrences for a single species. The taxonomy of the user-specified species will be verified using EOL and NCBI taxonomies by default.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simple search</span>
<span class="va">mySimpleOccCiteObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/occQuery.html">occQuery</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Protea cynaroides"</span>,
                            datasources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gbif"</span>, <span class="st">"bien"</span><span class="op">)</span>,
                            GBIFLogin <span class="op">=</span> <span class="va">GBIFLogin</span>, 
                            GBIFDownloadDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">path.package</a></span><span class="op">(</span><span class="st">"occCite"</span><span class="op">)</span>, <span class="st">"/extdata/"</span><span class="op">)</span>,
                            checkPreviousGBIFDownload <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">## Error in is.nan(x): default method not implemented for type 'list'</span></span></code></pre></div>
<p>Here is what the GBIF results look like:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># GBIF search results</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mySimpleOccCiteObject</span><span class="op">@</span><span class="va">occResults</span><span class="op">$</span><span class="va">`Protea cynaroides`</span><span class="op">$</span><span class="va">GBIF</span><span class="op">$</span><span class="va">OccurrenceTable</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## Error in head(mySimpleOccCiteObject@occResults$`Protea cynaroides`$GBIF$OccurrenceTable): object 'mySimpleOccCiteObject' not found</span></span></code></pre></div>
<p>And here are the BIEN results:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#BIEN search results</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mySimpleOccCiteObject</span><span class="op">@</span><span class="va">occResults</span><span class="op">$</span><span class="va">`Protea cynaroides`</span><span class="op">$</span><span class="va">BIEN</span><span class="op">$</span><span class="va">OccurrenceTable</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## Error in head(mySimpleOccCiteObject@occResults$`Protea cynaroides`$BIEN$OccurrenceTable): object 'mySimpleOccCiteObject' not found</span></span></code></pre></div>
<p>There is also a summary method for <code>occCite</code> objects with some basic information about your search.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mySimpleOccCiteObject</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## Error in summary(mySimpleOccCiteObject): object 'mySimpleOccCiteObject' not found</span></span></code></pre></div>
</div>
<div id="simple-citations" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-citations" class="anchor"></a>Simple citations</h2>
<p>After doing a search for occurrence points, you can use <code><a href="reference/occCitation.html">occCitation()</a></code> to generate citations for primary biodiversity databases, as well as database aggregators. <strong>Note:</strong> Currently, GBIF and BIEN are the only aggregators for which citations are supported.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Get citations</span>
<span class="va">mySimpleOccCitations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/occCitation.html">occCitation</a></span><span class="op">(</span><span class="va">mySimpleOccCiteObject</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">## Error in occCitation(mySimpleOccCiteObject): object 'mySimpleOccCiteObject' not found</span></span></code></pre></div>
<p>Here is a simple way of generating a formatted citation document from the results of <code><a href="reference/occCitation.html">occCitation()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mySimpleOccCitations</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">## Error in print(mySimpleOccCitations): object 'mySimpleOccCitations' not found</span></span></code></pre></div>
</div>
<div id="simple-taxonomic-rectification" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-taxonomic-rectification" class="anchor"></a>Simple Taxonomic Rectification</h2>
<p>In the simplest of searches, such as the one above, the taxonomy of your input species name is automatically rectified through the <code>occCite</code> function <code><a href="reference/studyTaxonList.html">studyTaxonList()</a></code> using <code>gnr_resolve()</code> from the <code>taxize</code> <code>R</code> package. If you would like to change the source of the taxonomy being used to rectify your species names, you can specify as many taxonomic repositories as you like from the Global Names Index (GNI). The complete list of GNI repositories can be found <a href="http://gni.globalnames.org/data_sources">here</a>.</p>
<p><code><a href="reference/studyTaxonList.html">studyTaxonList()</a></code> chooses the taxonomic names closest to those being input and documents which taxonomic repositories agreed with those names. <code><a href="reference/studyTaxonList.html">studyTaxonList()</a></code> instantiates an <code>occCiteData</code> object the same way <code><a href="reference/occQuery.html">occQuery()</a></code> does. This object can be passed into <code><a href="reference/occQuery.html">occQuery()</a></code> to perform your occurrence data search.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Rectify taxonomy</span>
<span class="va">myTROccCiteObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/studyTaxonList.html">studyTaxonList</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Protea cynaroides"</span>, 
                                  datasources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NCBI"</span>, <span class="st">"EOL"</span>, <span class="st">"ITIS"</span><span class="op">)</span><span class="op">)</span>
<span class="va">myTROccCiteObject</span><span class="op">@</span><span class="va">cleanedTaxonomy</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">##          Input Name        Best Match Taxonomic Databases w/ Matches</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">## 1 Protea cynaroides Protea cynaroides                           NCBI</span></span></code></pre></div>
<hr>
</div>
</div>
<div id="advanced-features" class="section level1">
<h1 class="hasAnchor">
<a href="#advanced-features" class="anchor"></a>Advanced features</h1>
<div id="loading-data-from-previous-gbif-searches" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-data-from-previous-gbif-searches" class="anchor"></a>Loading data from previous GBIF searches</h2>
<p>Querying GBIF can take quite a bit of time, especially for multiple species and/or well-known species. In this case, you may wish to access previously-downloaded data sets from your computer by specifying the general location of your downloaded <code>.zip</code> files. <code>occQuery</code> will crawl through your specified <code>GBIFDownloadDirectory</code> to collect all the <code>.zip</code> files contained in that folder and its subfolders. It will then import the most recent downloads that match your taxon list. These GBIF data will be appended to a BIEN search the same as if you do the simple real-time search (if you chose BIEN as well as GBIF), as was shown above. <code>checkPreviousGBIFDownload</code> is <code>TRUE</code> by default, but if <code>loadLocalGBIFDownload</code> is <code>TRUE</code>, <code>occQuery</code> will ignore <code>checkPreviousDownload</code>. It is also worth noting that <code>occCite</code> does not currently support mixed data download sources. That is, you cannot do GBIF queries for some taxa, download previously-prepared data sets for others, and load the rest from local data sets on your computer.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simple load</span>
<span class="va">myOldOccCiteObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/occQuery.html">occQuery</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Protea cynaroides"</span>, 
                                  datasources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gbif"</span>, <span class="st">"bien"</span><span class="op">)</span>, 
                                  GBIFLogin <span class="op">=</span> <span class="cn">NULL</span>, 
                                  GBIFDownloadDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">path.package</a></span><span class="op">(</span><span class="st">"occCite"</span><span class="op">)</span>, <span class="st">"/extdata/"</span><span class="op">)</span>,
                                  loadLocalGBIFDownload <span class="op">=</span> <span class="cn">T</span>,
                                  checkPreviousGBIFDownload <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">## Error in is.nan(x): default method not implemented for type 'list'</span></span></code></pre></div>
<p>Here is the result. Look familiar?</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#GBIF search results</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">myOldOccCiteObject</span><span class="op">@</span><span class="va">occResults</span><span class="op">$</span><span class="va">`Protea cynaroides`</span><span class="op">$</span><span class="va">GBIF</span><span class="op">$</span><span class="va">OccurrenceTable</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">## Error in head(myOldOccCiteObject@occResults$`Protea cynaroides`$GBIF$OccurrenceTable): object 'myOldOccCiteObject' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#The full summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">myOldOccCiteObject</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">## Error in summary(myOldOccCiteObject): object 'myOldOccCiteObject' not found</span></span></code></pre></div>
<p>Getting citation data works the exact same way with previously-downloaded data as it does from a fresh dataset.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Get citations</span>
<span class="va">myOldOccCitations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/occCitation.html">occCitation</a></span><span class="op">(</span><span class="va">myOldOccCiteObject</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">## Error in occCitation(myOldOccCiteObject): object 'myOldOccCiteObject' not found</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">myOldOccCitations</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">## Error in print(myOldOccCitations): object 'myOldOccCitations' not found</span></span></code></pre></div>
<p>Note that you can also load multiple species using either a vector of species names or a phylogeny (provided you have previously downloaded data for all of the species of interest), and you can load occurrences from non-GBIF data sources (e.g. BIEN) in the same query.</p>
<hr>
</div>
<div id="performing-a-multi-species-search" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-a-multi-species-search" class="anchor"></a>Performing a Multi-Species Search</h2>
<p>In addition to doing a simple, single species search, you can also use <code>occCite</code> to search for and manage occurrence datasets for multiple species. You can either submit a vector of species names, or you can submit a <em>phylogeny</em>!</p>
</div>
<div id="occcite-with-a-phylogeny" class="section level2">
<h2 class="hasAnchor">
<a href="#occcite-with-a-phylogeny" class="anchor"></a>occCite with a Phylogeny</h2>
<p>Here is an example of how such a search is structured, using an unpublished phylogeny of billfishes.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="co">#Get tree</span>
<span class="va">treeFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/Fish_12Tax_time_calibrated.tre"</span>, package<span class="op">=</span><span class="st">'occCite'</span><span class="op">)</span>
<span class="va">phylogeny</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.nexus.html">read.nexus</a></span><span class="op">(</span><span class="va">treeFile</span><span class="op">)</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">extract.clade</a></span><span class="op">(</span><span class="va">phylogeny</span>, <span class="fl">18</span><span class="op">)</span>
<span class="co">#Query databases for names</span>
<span class="va">myPhyOccCiteObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/studyTaxonList.html">studyTaxonList</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tree</span>, datasources <span class="op">=</span> <span class="st">"NCBI"</span><span class="op">)</span>
<span class="co">#Query GBIF for occurrence data</span>
<span class="va">myPhyOccCiteObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/occQuery.html">occQuery</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">myPhyOccCiteObject</span>, 
                            datasources <span class="op">=</span> <span class="st">"gbif"</span>,
                            GBIFDownloadDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">path.package</a></span><span class="op">(</span><span class="st">"occCite"</span><span class="op">)</span>, <span class="st">"/extdata/"</span><span class="op">)</span>, 
                            loadLocalGBIFDownload <span class="op">=</span> <span class="cn">T</span>,
                            checkPreviousGBIFDownload <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">## Error in is.nan(x): default method not implemented for type 'list'</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What does a multispecies query look like?</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">myPhyOccCiteObject</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">##  </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">##      </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">##  User query type: User-supplied phylogeny.</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co">##  </span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co">##  Sources for taxonomic rectification: NCBI</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co">##      </span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co">##  </span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co">##  Taxonomic cleaning results:     </span></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co">## </span></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="co">##                   Input Name                 Best Match</span></span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="co">## 1           Istiompax_indica           Istiompax indica</span></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co">## 2             Kajikia_albida             Kajikia albida</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co">## 3              Kajikia_audax              Kajikia audax</span></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="co">## 4 Tetrapturus_angustirostris Tetrapturus angustirostris</span></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="co">## 5         Tetrapturus_belone         Tetrapturus belone</span></span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="co">## 6        Tetrapturus_georgii        Tetrapturus georgii</span></span>
<span id="cb29-17"><a href="#cb29-17"></a><span class="co">## 7      Tetrapturus_pfluegeri      Tetrapturus pfluegeri</span></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="co">##   Taxonomic Databases w/ Matches</span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="co">## 1                           NCBI</span></span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="co">## 2                           NCBI</span></span>
<span id="cb29-21"><a href="#cb29-21"></a><span class="co">## 3                           NCBI</span></span>
<span id="cb29-22"><a href="#cb29-22"></a><span class="co">## 4                           NCBI</span></span>
<span id="cb29-23"><a href="#cb29-23"></a><span class="co">## 5                           NCBI</span></span>
<span id="cb29-24"><a href="#cb29-24"></a><span class="co">## 6                           NCBI</span></span>
<span id="cb29-25"><a href="#cb29-25"></a><span class="co">## 7                           NCBI</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Get citations</span>
<span class="va">myPhyOccCitations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/occCitation.html">occCitation</a></span><span class="op">(</span><span class="va">myPhyOccCiteObject</span><span class="op">)</span>

<span class="co">#Print citations as text with accession dates.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">myPhyOccCitations</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">## Warning in utils::citation(pkg): no date field in DESCRIPTION file of package</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">## 'occCite'</span></span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">## Warning in utils::citation(pkg): could not determine year for 'occCite' from</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">## package DESCRIPTION file</span></span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">## Ignoring entry titled "occCite: Querying and Managing Large Biodiversity Occurrence Datasets" because owensocccite: A bibentry of bibtype 'Manual' has to specify the field: c("year", "date")</span></span>
<span id="cb31-8"><a href="#cb31-8"></a></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">## Writing 1 Bibtex entries ... OK</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co">## Results written to file 'temp.bib'</span></span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="co">## Warning: `as_data_frame()` is deprecated as of tibble 2.0.0.</span></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="co">## Please use `as_tibble()` instead.</span></span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="co">## The signature and semantics have changed, see `?as_tibble`.</span></span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="co">## This warning is displayed once every 8 hours.</span></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co">## Call `lifecycle::last_warnings()` to see where this warning was generated.</span></span>
<span id="cb31-17"><a href="#cb31-17"></a></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="co">## Error in order(recordCitations$Citation): argument 1 is not a vector</span></span></code></pre></div>
<p>It is also possible to print citations separated by species.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">myPhyOccCitations</span>, bySpecies <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">## Error in x$occCitationResults[[i]]: subscript out of bounds</span></span></code></pre></div>
<hr>
</div>
</div>
<div id="visualization-features" class="section level1">
<h1 class="hasAnchor">
<a href="#visualization-features" class="anchor"></a>Visualization features</h1>
<div id="search-result-summary-figures" class="section level2">
<h2 class="hasAnchor">
<a href="#search-result-summary-figures" class="anchor"></a>Search result summary figures</h2>
<p>occCite includes a <code>plot</code> method for <code>occCiteData</code> objects, which is capable of generating three types of plots. First, let’s see how the results of our multiple species query looks.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">myPhyOccCiteObject</span>, 
               bySpecies <span class="op">=</span> <span class="cn">F</span>, 
               plotTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yearHistogram"</span>, <span class="st">"source"</span>, <span class="st">"aggregator"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">## Error in d.res[[x]]: subscript out of bounds</span></span></code></pre></div>
<p>We can also generate plots for each species in the <code>occCiteData</code> object individually. Since GBIF is the only aggregator we used for the query, I’ll skip generating the aggregator plot.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">myPhyOccCiteObject</span>, 
               bySpecies <span class="op">=</span> <span class="cn">T</span>, 
               plotTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yearHistogram"</span>, <span class="st">"source"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co">## Error in d.res[[x]]: subscript out of bounds</span></span></code></pre></div>
</div>
<div id="mapping-occcite-search-results" class="section level2">
<h2 class="hasAnchor">
<a href="#mapping-occcite-search-results" class="anchor"></a>Mapping occCite search results</h2>
<p>occCite also contains tools to map search results. We can pass occCite objects to be mapped as an interactive html widget using <code>leaflet</code>. If there are multiple species in a single occCite object, occurrences will be color-coded by species. If you click on a single occurrence, you will be able to see the species, the coordinates, the date on which it was collected, the dataset to which it belongs, and the dataservice that provided the record.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/occCiteMap.html">occCiteMap</a></span><span class="op">(</span><span class="va">mySimpleOccCiteObject</span>, cluster <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
</div>


  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>



      <footer>
      <div class="copyright">
  <p>Developed by Hannah L. Owens, Cory Merow, Brian Maitner, Jamie M. Kass, Vijay Barve, Robert P. Guralnick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


